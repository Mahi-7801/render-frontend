container_commands:
  01_install_mariadb:
    command: |
      # Install MariaDB server
      sudo yum install -y mariadb-server mariadb
      # Start MariaDB service
      sudo systemctl start mariadb
      sudo systemctl enable mariadb
      # Secure the installation
      sudo mysql_secure_installation <<EOF
      
      y
      thanuja
      thanuja
      y
      y
      y
      y
      EOF
    ignoreErrors: true
    
  02_configure_mariadb:
    command: |
      # Create database and user
      sudo mysql -u root -pthanuja <<EOF
      CREATE DATABASE IF NOT EXISTS toolinformation;
      USE toolinformation;
      CREATE USER IF NOT EXISTS 'root'@'localhost' IDENTIFIED BY 'thanuja';
      GRANT ALL PRIVILEGES ON toolinformation.* TO 'root'@'localhost';
      FLUSH PRIVILEGES;
      EOF
    ignoreErrors: true
    
  03_configure_mariadb_port:
    command: |
      # Configure MariaDB to listen on port 3307
      sudo sed -i 's/port=3306/port=3307/' /etc/my.cnf.d/server.cnf
      sudo systemctl restart mariadb
    ignoreErrors: true 